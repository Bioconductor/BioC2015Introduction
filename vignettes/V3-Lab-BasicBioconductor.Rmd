---
title: "3. Basic Lab for R & Bioconductor "
author: "Sonali Arora"
output:
  BiocStyle::html_document:
    toc: true
    toc_depth: 2
vignette: >
  % \VignetteIndexEntry{3. Basic Lab for R & Bioconductor}
  % \VignetteEngine{knitr::rmarkdown}
---
```{r style, echo = FALSE, results = 'asis'}
BiocStyle::markdown()
options(width=100, max.print=1000)
knitr::opts_chunk$set(
    eval=as.logical(Sys.getenv("KNITR_EVAL", "TRUE")),
    cache=as.logical(Sys.getenv("KNITR_CACHE", "TRUE")))
```

Author: Sonali Arora (<a
  href="mailto:sarora@fredhutch.org">sarora@fredhutch.org</a>)<br/ >
Date: 20-22 July, 2015<br />

The material in this course requires R version 3.2.1 and Bioconductor
version 3.2


## Basic lab for Bioconductor 

__Exercise 1__  
How do you download any package from Bioconductor ? More precisely what 
commands do you use? 

__Exercise 2__  
Using the given GRanges , do the following   
- Extract ranges only from chromosome 3  
- Extract the first five ranges from the GRanges.  
- Extract the score and gc column of the GRanges  
- Keep only the standard chromosomes (i.e.) from chromosome 1 to 22, X,Y,M.  
- Change the chromosome naming style i.e. this GRanges contains UCSC style  
of chromosome names, change them to NCBI style of chromosome names.   
- How do you find out the ranges contained in the gaps of this GRanges object?  
- How do you find out the degree of overlap for all the ranges in a   
GRanges object ? ( Hint: ?coverage)  


```{r}
library(GenomicRanges)
gr <-
 GRanges(seqnames = paste0("chr", c(1:22, tail(letters, 11))),
 ranges = IRanges(start=1:33, width = 1000 ),
 strand = c(rep("+", 10), rep("-", 23)),
 score = 1:33,
 GC = seq(1, 0, length=33))
```  



## Solutions

__Answer 1__  
If the package we are trying to download is called *GenomeInfoDb* then 
```{r load-pkg, eval=FALSE}
source("http://bioconductor.org/biocLite.R")
biocLite("GenomeInfoDb")
```

__Answer 2__
```{r gr-pkg}

gr <-
 GRanges(seqnames = paste0("chr", c(1:22, tail(letters, 11))),
 ranges = IRanges(start=1:33, width = 1000 ),
 strand = c(rep("+", 10), rep("-", 23)),
 score = 1:33,
 GC = seq(1, 0, length=33))

# extract ranges only from chromosome 3 
gr[seqnames(gr) %in% "chr3",]

# extract the first five ranges from the GRanges.
gr[1:5, ]

# extract the score and sequence column from a GRanges
mcols(gr)

# keep only the standard chromosomes (i.e.) from chromosome 1 to 22, x, y,m
keepStandardChromosomes(gr)

# change the chromosome naming style to NCBI
seqlevelsStyle(gr) <- "NCBI"
gr

# gaps in the ranges
gaps(gr)

# find degree of overlap for ranges.
coverage(gr)

```

## `sessionInfo()`

```{r sessionInfo}
sessionInfo()
```
